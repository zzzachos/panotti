Last login: Sun Dec  8 19:52:33 on ttys000
(base) DNa1c06a0:~ evangelie$ cd ~/Documents/GitHub/panotti/
(base) DNa1c06a0:panotti evangelie$ source activate tensorflow
(tensorflow) DNa1c06a0:panotti evangelie$ python experiments.py
['/Users/evangelie/Documents/GitHub/panotti', '/miniconda3/envs/tensorflow/lib/python37.zip', '/miniconda3/envs/tensorflow/lib/python3.7', '/miniconda3/envs/tensorflow/lib/python3.7/lib-dynload', '/Users/evangelie/.local/lib/python3.7/site-packages', '/miniconda3/envs/tensorflow/lib/python3.7/site-packages']
3.7.5 (default, Oct 25 2019, 10:52:18) 
[Clang 4.0.1 (tags/RELEASE_401/final)]
Using TensorFlow backend.
class_names =  ['ANG', 'DIS', 'FEA', 'HAP', 'NEU', 'SAD']
       total files =  2126 , going to load total_load =  2048
total files =  2126 , going to load total_load =  2048
   get_sample_dimensions: 1068_DFA_ANG_XX.wav.npz: melgram.shape =  (1, 96, 420, 1)
 melgram dimensions:  (1, 96, 420, 1)

 Loading class 1/6: 'ANG', File 1/345: Preprocessed/Train/ANG/1069_ITH_ANG_XX.wa Loading class 1/6: 'ANG', File 101/345: Preprocessed/Train/ANG/1014_IWW_ANG_XX. Loading class 1/6: 'ANG', File 201/345: Preprocessed/Train/ANG/1028_ITH_ANG_XX. Loading class 1/6: 'ANG', File 301/345: Preprocessed/Train/ANG/1053_IWW_ANG_XX. Loading class 1/6: 'ANG', File 345/345: Preprocessed/Train/ANG/1006_IEO_ANG_MD.wav.npz                  
 Loading class 2/6: 'DIS', File 1/374: Preprocessed/Train/DIS/1002_IWL_DIS_XX.wa Loading class 2/6: 'DIS', File 101/374: Preprocessed/Train/DIS/1026_IEO_DIS_HI. Loading class 2/6: 'DIS', File 201/374: Preprocessed/Train/DIS/1075_IOM_DIS_XX. Loading class 2/6: 'DIS', File 301/374: Preprocessed/Train/DIS/1061_DFA_DIS_XX. Loading class 2/6: 'DIS', File 374/374: Preprocessed/Train/DIS/1046_ITH_DIS_XX.wav.npz                  
 Loading class 3/6: 'FEA', File 1/343: Preprocessed/Train/FEA/1030_DFA_FEA_XX.wa Loading class 3/6: 'FEA', File 101/343: Preprocessed/Train/FEA/1050_IEO_FEA_LO. Loading class 3/6: 'FEA', File 201/343: Preprocessed/Train/FEA/1079_TIE_FEA_XX. Loading class 3/6: 'FEA', File 301/343: Preprocessed/Train/FEA/1068_IOM_FEA_XX. Loading class 3/6: 'FEA', File 343/343: Preprocessed/Train/FEA/1067_TSI_FEA_XX.wav.npz                  
 Loading class 4/6: 'HAP', File 1/363: Preprocessed/Train/HAP/1083_IEO_HAP_HI.wa Loading class 4/6: 'HAP', File 101/363: Preprocessed/Train/HAP/1040_IEO_HAP_MD. Loading class 4/6: 'HAP', File 201/363: Preprocessed/Train/HAP/1026_IWL_HAP_XX. Loading class 4/6: 'HAP', File 301/363: Preprocessed/Train/HAP/1041_DFA_HAP_XX. Loading class 4/6: 'HAP', File 363/363: Preprocessed/Train/HAP/1077_IEO_HAP_LO.wav.npz                  
 Loading class 5/6: 'NEU', File 1/328: Preprocessed/Train/NEU/1043_IOM_NEU_XX.wa Loading class 5/6: 'NEU', File 101/328: Preprocessed/Train/NEU/1039_IEO_NEU_XX. Loading class 5/6: 'NEU', File 201/328: Preprocessed/Train/NEU/1072_TIE_NEU_XX. Loading class 5/6: 'NEU', File 301/328: Preprocessed/Train/NEU/1018_TIE_NEU_XX. Loading class 5/6: 'NEU', File 328/328: Preprocessed/Train/NEU/1037_IWL_NEU_XX.wav.npz                  
 Loading class 6/6: 'SAD', File 1/373: Preprocessed/Train/SAD/1039_IWL_SAD_XX.wa Loading class 6/6: 'SAD', File 101/373: Preprocessed/Train/SAD/1018_IWL_SAD_XX. Loading class 6/6: 'SAD', File 201/373: Preprocessed/Train/SAD/1027_ITH_SAD_XX.wav.npz                  
 MyCNN_Keras2: X_shape =  (2048, 96, 420, 1) , channels =  1
2019-12-08 20:49:33.130793: I tensorflow/core/platform/cpu_feature_guard.cc:145] This TensorFlow binary is optimized with Intel(R) MKL-DNN to use the following CPU instructions in performance critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in non-MKL-DNN operations, rebuild TensorFlow with the appropriate compiler flags.
2019-12-08 20:49:33.131145: I tensorflow/core/common_runtime/process_util.cc:115] Creating new thread pool with default inter op setting: 4. Tune using inter_op_parallelism_threads for best performance.
WARNING:tensorflow:Large dropout rate: 0.6 (>0.5). In TensorFlow 2.x, dropout() uses dropout rate instead of keep_prob. Please ensure that this is intended.
Looking for previous weights...
No weights file detected, so starting from scratch.
 Available GPUs =  [] , count =  0
Summary of serial model (duplicated across 0 GPUs):
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
Input (Conv2D)               (None, 96, 420, 32)       320       
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 48, 210, 32)       0         
_________________________________________________________________
activation_1 (Activation)    (None, 48, 210, 32)       0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 48, 210, 32)       128       
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 48, 210, 32)       9248      
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 24, 105, 32)       0         
_________________________________________________________________
activation_2 (Activation)    (None, 24, 105, 32)       0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 24, 105, 32)       0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 24, 105, 32)       9248      
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 12, 52, 32)        0         
_________________________________________________________________
activation_3 (Activation)    (None, 12, 52, 32)        0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 12, 52, 32)        0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 12, 52, 32)        9248      
_________________________________________________________________
max_pooling2d_4 (MaxPooling2 (None, 6, 26, 32)         0         
_________________________________________________________________
activation_4 (Activation)    (None, 6, 26, 32)         0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 6, 26, 32)         0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 4992)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 128)               639104    
_________________________________________________________________
activation_5 (Activation)    (None, 128)               0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 6)                 774       
_________________________________________________________________
Output (Activation)          (None, 6)                 0         
=================================================================
Total params: 668,070
Trainable params: 668,006
Non-trainable params: 64
_________________________________________________________________
Epoch 1/10
^CTraceback (most recent call last):
  File "experiments.py", line 161, in <module>
    morecontinuerundropoutexperiment(6)
  File "experiments.py", line 122, in morecontinuerundropoutexperiment
    train_network(weights_file_in = inpath, weights_file_out = outpath, epochs=epochnum, batch_size=128, val_split=0, convdropout=c, densdropout=d)    
  File "experiments.py", line 63, in train_network
    verbose=1, callbacks=[checkpointer])#v5 commented out validation_split=val_split, validation_data=(X_train, Y_train))
  File "/miniconda3/envs/tensorflow/lib/python3.7/site-packages/keras/engine/training.py", line 1239, in fit
    validation_freq=validation_freq)
  File "/miniconda3/envs/tensorflow/lib/python3.7/site-packages/keras/engine/training_arrays.py", line 196, in fit_loop
    outs = fit_function(ins_batch)
  File "/miniconda3/envs/tensorflow/lib/python3.7/site-packages/tensorflow_core/python/keras/backend.py", line 3740, in __call__
    outputs = self._graph_fn(*converted_inputs)
  File "/miniconda3/envs/tensorflow/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py", line 1081, in __call__
    return self._call_impl(args, kwargs)
  File "/miniconda3/envs/tensorflow/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py", line 1121, in _call_impl
    return self._call_flat(args, self.captured_inputs, cancellation_manager)
  File "/miniconda3/envs/tensorflow/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py", line 1224, in _call_flat
    ctx, args, cancellation_manager=cancellation_manager)
  File "/miniconda3/envs/tensorflow/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py", line 511, in call
    ctx=ctx)
  File "/miniconda3/envs/tensorflow/lib/python3.7/site-packages/tensorflow_core/python/eager/execute.py", line 61, in quick_execute
    num_outputs)
KeyboardInterrupt
(tensorflow) DNa1c06a0:panotti evangelie$ python experiments.py
['/Users/evangelie/Documents/GitHub/panotti', '/miniconda3/envs/tensorflow/lib/python37.zip', '/miniconda3/envs/tensorflow/lib/python3.7', '/miniconda3/envs/tensorflow/lib/python3.7/lib-dynload', '/Users/evangelie/.local/lib/python3.7/site-packages', '/miniconda3/envs/tensorflow/lib/python3.7/site-packages']
3.7.5 (default, Oct 25 2019, 10:52:18) 
[Clang 4.0.1 (tags/RELEASE_401/final)]
Using TensorFlow backend.
class_names =  ['ANG', 'DIS', 'FEA', 'HAP', 'NEU', 'SAD']
       total files =  2126 , going to load total_load =  2048
total files =  2126 , going to load total_load =  2048
   get_sample_dimensions: 1068_DFA_ANG_XX.wav.npz: melgram.shape =  (1, 96, 420, 1)
 melgram dimensions:  (1, 96, 420, 1)

 Loading class 1/6: 'ANG', File 1/345: Preprocessed/Train/ANG/1009_WSI_ANG_XX.wa Loading class 1/6: 'ANG', File 101/345: Preprocessed/Train/ANG/1007_TAI_ANG_XX. Loading class 1/6: 'ANG', File 201/345: Preprocessed/Train/ANG/1047_IEO_ANG_HI. Loading class 1/6: 'ANG', File 301/345: Preprocessed/Train/ANG/1090_DFA_ANG_XX. Loading class 1/6: 'ANG', File 345/345: Preprocessed/Train/ANG/1021_IWL_ANG_XX.wav.npz                  
 Loading class 2/6: 'DIS', File 1/374: Preprocessed/Train/DIS/1014_TAI_DIS_XX.wa Loading class 2/6: 'DIS', File 101/374: Preprocessed/Train/DIS/1076_IOM_DIS_XX. Loading class 2/6: 'DIS', File 201/374: Preprocessed/Train/DIS/1003_MTI_DIS_XX. Loading class 2/6: 'DIS', File 301/374: Preprocessed/Train/DIS/1075_IOM_DIS_XX. Loading class 2/6: 'DIS', File 374/374: Preprocessed/Train/DIS/1086_DFA_DIS_XX.wav.npz                  
 Loading class 3/6: 'FEA', File 1/343: Preprocessed/Train/FEA/1009_IWL_FEA_XX.wa Loading class 3/6: 'FEA', File 101/343: Preprocessed/Train/FEA/1030_DFA_FEA_XX. Loading class 3/6: 'FEA', File 201/343: Preprocessed/Train/FEA/1051_ITH_FEA_XX. Loading class 3/6: 'FEA', File 301/343: Preprocessed/Train/FEA/1062_TSI_FEA_XX. Loading class 3/6: 'FEA', File 343/343: Preprocessed/Train/FEA/1088_TIE_FEA_XX.wav.npz                  
 Loading class 4/6: 'HAP', File 1/363: Preprocessed/Train/HAP/1081_MTI_HAP_XX.wa Loading class 4/6: 'HAP', File 101/363: Preprocessed/Train/HAP/1079_WSI_HAP_XX. Loading class 4/6: 'HAP', File 201/363: Preprocessed/Train/HAP/1076_IWW_HAP_XX. Loading class 4/6: 'HAP', File 301/363: Preprocessed/Train/HAP/1071_WSI_HAP_XX. Loading class 4/6: 'HAP', File 363/363: Preprocessed/Train/HAP/1071_MTI_HAP_XX.wav.npz                  
 Loading class 5/6: 'NEU', File 1/328: Preprocessed/Train/NEU/1067_TIE_NEU_XX.wa Loading class 5/6: 'NEU', File 101/328: Preprocessed/Train/NEU/1025_IWL_NEU_XX. Loading class 5/6: 'NEU', File 201/328: Preprocessed/Train/NEU/1050_MTI_NEU_XX. Loading class 5/6: 'NEU', File 301/328: Preprocessed/Train/NEU/1070_IOM_NEU_XX. Loading class 5/6: 'NEU', File 328/328: Preprocessed/Train/NEU/1022_WSI_NEU_XX.wav.npz                  
 Loading class 6/6: 'SAD', File 1/373: Preprocessed/Train/SAD/1013_IEO_SAD_LO.wa Loading class 6/6: 'SAD', File 101/373: Preprocessed/Train/SAD/1089_IWW_SAD_XX. Loading class 6/6: 'SAD', File 201/373: Preprocessed/Train/SAD/1075_IEO_SAD_MD.wav.npz                  
 MyCNN_Keras2: X_shape =  (2048, 96, 420, 1) , channels =  1
2019-12-08 20:50:38.013809: I tensorflow/core/platform/cpu_feature_guard.cc:145] This TensorFlow binary is optimized with Intel(R) MKL-DNN to use the following CPU instructions in performance critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in non-MKL-DNN operations, rebuild TensorFlow with the appropriate compiler flags.
2019-12-08 20:50:38.014134: I tensorflow/core/common_runtime/process_util.cc:115] Creating new thread pool with default inter op setting: 4. Tune using inter_op_parallelism_threads for best performance.
WARNING:tensorflow:Large dropout rate: 0.7 (>0.5). In TensorFlow 2.x, dropout() uses dropout rate instead of keep_prob. Please ensure that this is intended.
Looking for previous weights...
Weights file detected. Loading from  60.5_convdropout0.5densedropout0.7weights.hdf5
WARNING:tensorflow:Large dropout rate: 0.7 (>0.5). In TensorFlow 2.x, dropout() uses dropout rate instead of keep_prob. Please ensure that this is intended.
 Available GPUs =  [] , count =  0
Summary of serial model (duplicated across 0 GPUs):
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
Input (Conv2D)               (None, 96, 420, 32)       320       
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 48, 210, 32)       0         
_________________________________________________________________
activation_1 (Activation)    (None, 48, 210, 32)       0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 48, 210, 32)       128       
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 48, 210, 32)       9248      
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 24, 105, 32)       0         
_________________________________________________________________
activation_2 (Activation)    (None, 24, 105, 32)       0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 24, 105, 32)       0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 24, 105, 32)       9248      
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 12, 52, 32)        0         
_________________________________________________________________
activation_3 (Activation)    (None, 12, 52, 32)        0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 12, 52, 32)        0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 12, 52, 32)        9248      
_________________________________________________________________
max_pooling2d_4 (MaxPooling2 (None, 6, 26, 32)         0         
_________________________________________________________________
activation_4 (Activation)    (None, 6, 26, 32)         0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 6, 26, 32)         0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 4992)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 128)               639104    
_________________________________________________________________
activation_5 (Activation)    (None, 128)               0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 6)                 774       
_________________________________________________________________
Output (Activation)          (None, 6)                 0         
=================================================================
Total params: 668,070
Trainable params: 668,006
Non-trainable params: 64
_________________________________________________________________
Epoch 1/10
2048/2048 [==============================] - 198s 97ms/step - loss: 1.1910 - accuracy: 0.5410

Epoch 00001: saving model to 60.8_convdropout0.5densedropout0.7weights.hdf5
Epoch 2/10
2048/2048 [==============================] - 184s 90ms/step - loss: 1.1872 - accuracy: 0.5498

Epoch 00002: saving model to 60.8_convdropout0.5densedropout0.7weights.hdf5
Epoch 3/10
2048/2048 [==============================] - 186s 91ms/step - loss: 1.1408 - accuracy: 0.5581

Epoch 00003: saving model to 60.8_convdropout0.5densedropout0.7weights.hdf5
Epoch 4/10
2048/2048 [==============================] - 182s 89ms/step - loss: 1.1903 - accuracy: 0.5347

Epoch 00004: saving model to 60.8_convdropout0.5densedropout0.7weights.hdf5
Epoch 5/10
2048/2048 [==============================] - 180s 88ms/step - loss: 1.1442 - accuracy: 0.5684

Epoch 00005: saving model to 60.8_convdropout0.5densedropout0.7weights.hdf5
Epoch 6/10
2048/2048 [==============================] - 188s 92ms/step - loss: 1.1459 - accuracy: 0.5542

Epoch 00006: saving model to 60.8_convdropout0.5densedropout0.7weights.hdf5
Epoch 7/10
2048/2048 [==============================] - 177s 86ms/step - loss: 1.1672 - accuracy: 0.5610

Epoch 00007: saving model to 60.8_convdropout0.5densedropout0.7weights.hdf5
Epoch 8/10
2048/2048 [==============================] - 176s 86ms/step - loss: 1.1581 - accuracy: 0.5552

Epoch 00008: saving model to 60.8_convdropout0.5densedropout0.7weights.hdf5
Epoch 9/10
2048/2048 [==============================] - 180s 88ms/step - loss: 1.1408 - accuracy: 0.5659

Epoch 00009: saving model to 60.8_convdropout0.5densedropout0.7weights.hdf5
Epoch 10/10
2048/2048 [==============================] - 170s 83ms/step - loss: 1.1793 - accuracy: 0.5503

Epoch 00010: saving model to 60.8_convdropout0.5densedropout0.7weights.hdf5
class_names =  ['ANG', 'DIS', 'FEA', 'HAP', 'NEU', 'SAD']
       total files =  266 , going to load total_load =  266
total files =  266 , going to load total_load =  266
   get_sample_dimensions: 1075_IEO_ANG_HI.wav.npz: melgram.shape =  (1, 96, 420, 1)
 melgram dimensions:  (1, 96, 420, 1)

 Loading class 1/6: 'ANG', File 1/44: Preprocessed/Train/../Dev/ANG/1019_DFA_ANG Loading class 1/6: 'ANG', File 44/44: Preprocessed/Train/../Dev/ANG/1066_IWL_ANG_XX.wav.npz                  
 Loading class 2/6: 'DIS', File 1/42: Preprocessed/Train/../Dev/DIS/1030_WSI_DIS Loading class 2/6: 'DIS', File 42/42: Preprocessed/Train/../Dev/DIS/1081_IEO_DIS_MD.wav.npz                  
 Loading class 3/6: 'FEA', File 1/62: Preprocessed/Train/../Dev/FEA/1069_TAI_FEA Loading class 3/6: 'FEA', File 62/62: Preprocessed/Train/../Dev/FEA/1038_IEO_FEA_HI.wav.npz                  
 Loading class 4/6: 'HAP', File 1/47: Preprocessed/Train/../Dev/HAP/1008_DFA_HAP Loading class 4/6: 'HAP', File 47/47: Preprocessed/Train/../Dev/HAP/1058_IWL_HAP_XX.wav.npz                  
 Loading class 5/6: 'NEU', File 1/31: Preprocessed/Train/../Dev/NEU/1013_IWL_NEU Loading class 5/6: 'NEU', File 31/31: Preprocessed/Train/../Dev/NEU/1023_DFA_NEU_XX.wav.npz                  
 Loading class 6/6: 'SAD', File 1/40: Preprocessed/Train/../Dev/SAD/1071_IWL_SAD Loading class 6/6: 'SAD', File 40/40: Preprocessed/Train/../Dev/SAD/1031_IEO_SAD_HI.wav.npz                  
adadelta  gives the following results:
Dev set loss: 1.2782718776760245
Dev set accuracy: 0.5
(tensorflow) DNa1c06a0:panotti evangelie$ python eval_network.py
Using TensorFlow backend.
class_names =  ['ANG', 'DIS', 'FEA', 'HAP', 'NEU', 'SAD']
       total files =  266 , going to load total_load =  240
total files =  266 , going to load total_load =  240
   get_sample_dimensions: 1075_IEO_ANG_HI.wav.npz: melgram.shape =  (1, 96, 420, 1)
 melgram dimensions:  (1, 96, 420, 1)

 Loading class 1/6: 'ANG', File 1/44: Preprocessed/Dev/ANG/1050_IEO_ANG_MD.wav.n Loading class 1/6: 'ANG', File 44/44: Preprocessed/Dev/ANG/1073_ITS_ANG_XX.wav.npz                  
 Loading class 2/6: 'DIS', File 1/42: Preprocessed/Dev/DIS/1069_ITH_DIS_XX.wav.n Loading class 2/6: 'DIS', File 42/42: Preprocessed/Dev/DIS/1062_MTI_DIS_XX.wav.npz                  
 Loading class 3/6: 'FEA', File 1/62: Preprocessed/Dev/FEA/1073_IEO_FEA_LO.wav.n Loading class 3/6: 'FEA', File 62/62: Preprocessed/Dev/FEA/1017_IEO_FEA_LO.wav.npz                  
 Loading class 4/6: 'HAP', File 1/47: Preprocessed/Dev/HAP/1057_ITS_HAP_XX.wav.n Loading class 4/6: 'HAP', File 47/47: Preprocessed/Dev/HAP/1075_TSI_HAP_XX.wav.npz                  
 Loading class 5/6: 'NEU', File 1/31: Preprocessed/Dev/NEU/1013_IWL_NEU_XX.wav.n Loading class 5/6: 'NEU', File 31/31: Preprocessed/Dev/NEU/1091_ITH_NEU_XX.wav.npz                  
 Loading class 6/6: 'SAD', File 1/40: Preprocessed/Dev/SAD/1041_IEO_SAD_LO.wav.npz                  
class names =  ['ANG', 'DIS', 'FEA', 'HAP', 'NEU', 'SAD']
 MyCNN_Keras2: X_shape =  (240, 96, 420, 1) , channels =  1
2019-12-08 21:44:33.641448: I tensorflow/core/platform/cpu_feature_guard.cc:145] This TensorFlow binary is optimized with Intel(R) MKL-DNN to use the following CPU instructions in performance critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in non-MKL-DNN operations, rebuild TensorFlow with the appropriate compiler flags.
2019-12-08 21:44:33.641817: I tensorflow/core/common_runtime/process_util.cc:115] Creating new thread pool with default inter op setting: 4. Tune using inter_op_parallelism_threads for best performance.
WARNING:tensorflow:Large dropout rate: 0.6 (>0.5). In TensorFlow 2.x, dropout() uses dropout rate instead of keep_prob. Please ensure that this is intended.
Looking for previous weights...
Need weights file to continue.  Aborting
Traceback (most recent call last):
  File "eval_network.py", line 180, in <module>
    eval_network(weights_file=args.weights, classpath=args.classpath, batch_size=args.batch_size)
  File "eval_network.py", line 70, in eval_network
    model, serial_model = setup_model(X_test, class_names, weights_file_in=weights_file, missing_weights_fatal=True)
  File "/Users/evangelie/Documents/GitHub/panotti/panotti/models.py", line 230, in setup_model
    assert(not missing_weights_fatal)
AssertionError
(tensorflow) DNa1c06a0:panotti evangelie$ python eval_network.py
Using TensorFlow backend.
class_names =  ['ANG', 'DIS', 'FEA', 'HAP', 'NEU', 'SAD']
       total files =  266 , going to load total_load =  240
total files =  266 , going to load total_load =  240
   get_sample_dimensions: 1075_IEO_ANG_HI.wav.npz: melgram.shape =  (1, 96, 420, 1)
 melgram dimensions:  (1, 96, 420, 1)

 Loading class 1/6: 'ANG', File 1/44: Preprocessed/Dev/ANG/1039_ITS_ANG_XX.wav.n Loading class 1/6: 'ANG', File 44/44: Preprocessed/Dev/ANG/1066_IWL_ANG_XX.wav.npz                  
 Loading class 2/6: 'DIS', File 1/42: Preprocessed/Dev/DIS/1076_MTI_DIS_XX.wav.n Loading class 2/6: 'DIS', File 42/42: Preprocessed/Dev/DIS/1019_TAI_DIS_XX.wav.npz                  
 Loading class 3/6: 'FEA', File 1/62: Preprocessed/Dev/FEA/1050_IOM_FEA_XX.wav.n Loading class 3/6: 'FEA', File 62/62: Preprocessed/Dev/FEA/1033_DFA_FEA_XX.wav.npz                  
 Loading class 4/6: 'HAP', File 1/47: Preprocessed/Dev/HAP/1041_IEO_HAP_LO.wav.n Loading class 4/6: 'HAP', File 47/47: Preprocessed/Dev/HAP/1025_IEO_HAP_LO.wav.npz                  
 Loading class 5/6: 'NEU', File 1/31: Preprocessed/Dev/NEU/1091_ITH_NEU_XX.wav.n Loading class 5/6: 'NEU', File 31/31: Preprocessed/Dev/NEU/1055_IWL_NEU_XX.wav.npz                  
 Loading class 6/6: 'SAD', File 1/40: Preprocessed/Dev/SAD/1019_MTI_SAD_XX.wav.npz                  
class names =  ['ANG', 'DIS', 'FEA', 'HAP', 'NEU', 'SAD']
 MyCNN_Keras2: X_shape =  (240, 96, 420, 1) , channels =  1
2019-12-08 21:45:19.925587: I tensorflow/core/platform/cpu_feature_guard.cc:145] This TensorFlow binary is optimized with Intel(R) MKL-DNN to use the following CPU instructions in performance critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in non-MKL-DNN operations, rebuild TensorFlow with the appropriate compiler flags.
2019-12-08 21:45:19.925937: I tensorflow/core/common_runtime/process_util.cc:115] Creating new thread pool with default inter op setting: 4. Tune using inter_op_parallelism_threads for best performance.
WARNING:tensorflow:Large dropout rate: 0.6 (>0.5). In TensorFlow 2.x, dropout() uses dropout rate instead of keep_prob. Please ensure that this is intended.
Looking for previous weights...
Weights file detected. Loading from  60.5_convdropout0.5densedropout0.7weights.hdf5
WARNING:tensorflow:Large dropout rate: 0.7 (>0.5). In TensorFlow 2.x, dropout() uses dropout rate instead of keep_prob. Please ensure that this is intended.
 Available GPUs =  [] , count =  0
Summary of serial model (duplicated across 0 GPUs):
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
Input (Conv2D)               (None, 96, 420, 32)       320       
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 48, 210, 32)       0         
_________________________________________________________________
activation_1 (Activation)    (None, 48, 210, 32)       0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 48, 210, 32)       128       
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 48, 210, 32)       9248      
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 24, 105, 32)       0         
_________________________________________________________________
activation_2 (Activation)    (None, 24, 105, 32)       0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 24, 105, 32)       0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 24, 105, 32)       9248      
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 12, 52, 32)        0         
_________________________________________________________________
activation_3 (Activation)    (None, 12, 52, 32)        0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 12, 52, 32)        0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 12, 52, 32)        9248      
_________________________________________________________________
max_pooling2d_4 (MaxPooling2 (None, 6, 26, 32)         0         
_________________________________________________________________
activation_4 (Activation)    (None, 6, 26, 32)         0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 6, 26, 32)         0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 4992)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 128)               639104    
_________________________________________________________________
activation_5 (Activation)    (None, 128)               0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 6)                 774       
_________________________________________________________________
Output (Activation)          (None, 6)                 0         
=================================================================
Total params: 668,070
Trainable params: 668,006
Non-trainable params: 64
_________________________________________________________________
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
Input (Conv2D)               (None, 96, 420, 32)       320       
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 48, 210, 32)       0         
_________________________________________________________________
activation_1 (Activation)    (None, 48, 210, 32)       0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 48, 210, 32)       128       
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 48, 210, 32)       9248      
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 24, 105, 32)       0         
_________________________________________________________________
activation_2 (Activation)    (None, 24, 105, 32)       0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 24, 105, 32)       0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 24, 105, 32)       9248      
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 12, 52, 32)        0         
_________________________________________________________________
activation_3 (Activation)    (None, 12, 52, 32)        0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 12, 52, 32)        0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 12, 52, 32)        9248      
_________________________________________________________________
max_pooling2d_4 (MaxPooling2 (None, 6, 26, 32)         0         
_________________________________________________________________
activation_4 (Activation)    (None, 6, 26, 32)         0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 6, 26, 32)         0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 4992)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 128)               639104    
_________________________________________________________________
activation_5 (Activation)    (None, 128)               0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 6)                 774       
_________________________________________________________________
Output (Activation)          (None, 6)                 0         
=================================================================
Total params: 668,070
Trainable params: 668,006
Non-trainable params: 64
_________________________________________________________________
Running predict...
Counting mistakes 
    Found 120 total mistakes out of 240 attempts
      Mistakes by class: 
          class 'ANG': 16
                   Preprocessed/Dev/ANG/1019_IEO_ANG_MD.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1040_TAI_ANG_XX.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1090_IEO_ANG_LO.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1077_MTI_ANG_XX.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1018_TAI_ANG_XX.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1071_IEO_ANG_LO.wav.npz: should be ANG but came out as NEU
                   Preprocessed/Dev/ANG/1085_IWW_ANG_XX.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1006_TSI_ANG_XX.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1009_TAI_ANG_XX.wav.npz: should be ANG but came out as FEA
                   Preprocessed/Dev/ANG/1089_WSI_ANG_XX.wav.npz: should be ANG but came out as FEA
                   Preprocessed/Dev/ANG/1073_ITS_ANG_XX.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1060_IEO_ANG_MD.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1019_DFA_ANG_XX.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1001_IEO_ANG_MD.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1078_MTI_ANG_XX.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1042_IEO_ANG_MD.wav.npz: should be ANG but came out as HAP
          class 'DIS': 32
                   Preprocessed/Dev/DIS/1019_TAI_DIS_XX.wav.npz: should be DIS but came out as NEU
                   Preprocessed/Dev/DIS/1005_IEO_DIS_MD.wav.npz: should be DIS but came out as HAP
                   Preprocessed/Dev/DIS/1048_MTI_DIS_XX.wav.npz: should be DIS but came out as FEA
                   Preprocessed/Dev/DIS/1042_IWW_DIS_XX.wav.npz: should be DIS but came out as NEU
                   Preprocessed/Dev/DIS/1020_DFA_DIS_XX.wav.npz: should be DIS but came out as SAD
                   Preprocessed/Dev/DIS/1072_IOM_DIS_XX.wav.npz: should be DIS but came out as FEA
                   Preprocessed/Dev/DIS/1011_IEO_DIS_HI.wav.npz: should be DIS but came out as HAP
                   Preprocessed/Dev/DIS/1062_IEO_DIS_HI.wav.npz: should be DIS but came out as NEU
                   Preprocessed/Dev/DIS/1033_WSI_DIS_XX.wav.npz: should be DIS but came out as FEA
                   Preprocessed/Dev/DIS/1060_TSI_DIS_XX.wav.npz: should be DIS but came out as SAD
                   Preprocessed/Dev/DIS/1069_ITH_DIS_XX.wav.npz: should be DIS but came out as NEU
                   Preprocessed/Dev/DIS/1078_ITS_DIS_XX.wav.npz: should be DIS but came out as HAP
                   Preprocessed/Dev/DIS/1001_IWW_DIS_XX.wav.npz: should be DIS but came out as NEU
                   Preprocessed/Dev/DIS/1074_IEO_DIS_HI.wav.npz: should be DIS but came out as ANG
                   Preprocessed/Dev/DIS/1072_ITS_DIS_XX.wav.npz: should be DIS but came out as HAP
                   Preprocessed/Dev/DIS/1060_IWL_DIS_XX.wav.npz: should be DIS but came out as NEU
                   Preprocessed/Dev/DIS/1041_TIE_DIS_XX.wav.npz: should be DIS but came out as SAD
                   Preprocessed/Dev/DIS/1056_TSI_DIS_XX.wav.npz: should be DIS but came out as HAP
                   Preprocessed/Dev/DIS/1086_TIE_DIS_XX.wav.npz: should be DIS but came out as NEU
                   Preprocessed/Dev/DIS/1088_ITS_DIS_XX.wav.npz: should be DIS but came out as NEU
                   Preprocessed/Dev/DIS/1085_DFA_DIS_XX.wav.npz: should be DIS but came out as NEU
                   Preprocessed/Dev/DIS/1062_MTI_DIS_XX.wav.npz: should be DIS but came out as SAD
                   Preprocessed/Dev/DIS/1037_ITS_DIS_XX.wav.npz: should be DIS but came out as SAD
                   Preprocessed/Dev/DIS/1044_IWL_DIS_XX.wav.npz: should be DIS but came out as ANG
                   Preprocessed/Dev/DIS/1024_TSI_DIS_XX.wav.npz: should be DIS but came out as SAD
                   Preprocessed/Dev/DIS/1079_IEO_DIS_LO.wav.npz: should be DIS but came out as HAP
                   Preprocessed/Dev/DIS/1037_MTI_DIS_XX.wav.npz: should be DIS but came out as SAD
                   Preprocessed/Dev/DIS/1059_TAI_DIS_XX.wav.npz: should be DIS but came out as NEU
                   Preprocessed/Dev/DIS/1067_TSI_DIS_XX.wav.npz: should be DIS but came out as NEU
                   Preprocessed/Dev/DIS/1074_ITH_DIS_XX.wav.npz: should be DIS but came out as ANG
                   Preprocessed/Dev/DIS/1053_IEO_DIS_MD.wav.npz: should be DIS but came out as NEU
                   Preprocessed/Dev/DIS/1053_IWW_DIS_XX.wav.npz: should be DIS but came out as NEU
          class 'FEA': 36
                   Preprocessed/Dev/FEA/1060_TAI_FEA_XX.wav.npz: should be FEA but came out as NEU
                   Preprocessed/Dev/FEA/1003_TIE_FEA_XX.wav.npz: should be FEA but came out as ANG
                   Preprocessed/Dev/FEA/1075_IWW_FEA_XX.wav.npz: should be FEA but came out as SAD
                   Preprocessed/Dev/FEA/1089_TSI_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1028_IEO_FEA_HI.wav.npz: should be FEA but came out as ANG
                   Preprocessed/Dev/FEA/1063_DFA_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1055_IWL_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1018_TAI_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1075_ITH_FEA_XX.wav.npz: should be FEA but came out as SAD
                   Preprocessed/Dev/FEA/1033_DFA_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1060_IEO_FEA_LO.wav.npz: should be FEA but came out as SAD
                   Preprocessed/Dev/FEA/1062_MTI_FEA_XX.wav.npz: should be FEA but came out as SAD
                   Preprocessed/Dev/FEA/1058_TAI_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1062_IOM_FEA_XX.wav.npz: should be FEA but came out as NEU
                   Preprocessed/Dev/FEA/1082_DFA_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1031_TSI_FEA_XX.wav.npz: should be FEA but came out as NEU
                   Preprocessed/Dev/FEA/1076_TIE_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1075_TAI_FEA_XX.wav.npz: should be FEA but came out as SAD
                   Preprocessed/Dev/FEA/1062_DFA_FEA_XX.wav.npz: should be FEA but came out as SAD
                   Preprocessed/Dev/FEA/1004_ITH_FEA_XX.wav.npz: should be FEA but came out as DIS
                   Preprocessed/Dev/FEA/1080_IEO_FEA_MD.wav.npz: should be FEA but came out as SAD
                   Preprocessed/Dev/FEA/1020_TAI_FEA_XX.wav.npz: should be FEA but came out as NEU
                   Preprocessed/Dev/FEA/1007_IEO_FEA_MD.wav.npz: should be FEA but came out as DIS
                   Preprocessed/Dev/FEA/1083_TSI_FEA_XX.wav.npz: should be FEA but came out as DIS
                   Preprocessed/Dev/FEA/1067_WSI_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1017_MTI_FEA_XX.wav.npz: should be FEA but came out as SAD
                   Preprocessed/Dev/FEA/1069_IWW_FEA_XX.wav.npz: should be FEA but came out as NEU
                   Preprocessed/Dev/FEA/1023_TIE_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1050_IOM_FEA_XX.wav.npz: should be FEA but came out as SAD
                   Preprocessed/Dev/FEA/1064_WSI_FEA_XX.wav.npz: should be FEA but came out as ANG
                   Preprocessed/Dev/FEA/1027_IOM_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1088_IWW_FEA_XX.wav.npz: should be FEA but came out as SAD
                   Preprocessed/Dev/FEA/1007_WSI_FEA_XX.wav.npz: should be FEA but came out as SAD
                   Preprocessed/Dev/FEA/1073_IEO_FEA_LO.wav.npz: should be FEA but came out as NEU
                   Preprocessed/Dev/FEA/1017_IEO_FEA_LO.wav.npz: should be FEA but came out as SAD
                   Preprocessed/Dev/FEA/1023_WSI_FEA_XX.wav.npz: should be FEA but came out as ANG
          class 'HAP': 20
                   Preprocessed/Dev/HAP/1025_IEO_HAP_LO.wav.npz: should be HAP but came out as NEU
                   Preprocessed/Dev/HAP/1025_IOM_HAP_XX.wav.npz: should be HAP but came out as FEA
                   Preprocessed/Dev/HAP/1074_ITS_HAP_XX.wav.npz: should be HAP but came out as FEA
                   Preprocessed/Dev/HAP/1084_TSI_HAP_XX.wav.npz: should be HAP but came out as DIS
                   Preprocessed/Dev/HAP/1041_IEO_HAP_LO.wav.npz: should be HAP but came out as SAD
                   Preprocessed/Dev/HAP/1045_DFA_HAP_XX.wav.npz: should be HAP but came out as NEU
                   Preprocessed/Dev/HAP/1039_IWL_HAP_XX.wav.npz: should be HAP but came out as ANG
                   Preprocessed/Dev/HAP/1059_DFA_HAP_XX.wav.npz: should be HAP but came out as FEA
                   Preprocessed/Dev/HAP/1029_WSI_HAP_XX.wav.npz: should be HAP but came out as FEA
                   Preprocessed/Dev/HAP/1081_IEO_HAP_LO.wav.npz: should be HAP but came out as NEU
                   Preprocessed/Dev/HAP/1022_IWW_HAP_XX.wav.npz: should be HAP but came out as NEU
                   Preprocessed/Dev/HAP/1088_TSI_HAP_XX.wav.npz: should be HAP but came out as DIS
                   Preprocessed/Dev/HAP/1008_DFA_HAP_XX.wav.npz: should be HAP but came out as FEA
                   Preprocessed/Dev/HAP/1058_MTI_HAP_XX.wav.npz: should be HAP but came out as FEA
                   Preprocessed/Dev/HAP/1055_MTI_HAP_XX.wav.npz: should be HAP but came out as FEA
                   Preprocessed/Dev/HAP/1040_IWL_HAP_XX.wav.npz: should be HAP but came out as NEU
                   Preprocessed/Dev/HAP/1051_TIE_HAP_XX.wav.npz: should be HAP but came out as DIS
                   Preprocessed/Dev/HAP/1012_IEO_HAP_LO.wav.npz: should be HAP but came out as FEA
                   Preprocessed/Dev/HAP/1030_ITS_HAP_XX.wav.npz: should be HAP but came out as FEA
                   Preprocessed/Dev/HAP/1085_TSI_HAP_XX.wav.npz: should be HAP but came out as NEU
          class 'NEU': 11
                   Preprocessed/Dev/NEU/1019_DFA_NEU_XX.wav.npz: should be NEU but came out as HAP
                   Preprocessed/Dev/NEU/1048_TSI_NEU_XX.wav.npz: should be NEU but came out as HAP
                   Preprocessed/Dev/NEU/1021_TSI_NEU_XX.wav.npz: should be NEU but came out as SAD
                   Preprocessed/Dev/NEU/1088_IOM_NEU_XX.wav.npz: should be NEU but came out as HAP
                   Preprocessed/Dev/NEU/1078_IEO_NEU_XX.wav.npz: should be NEU but came out as SAD
                   Preprocessed/Dev/NEU/1086_TSI_NEU_XX.wav.npz: should be NEU but came out as HAP
                   Preprocessed/Dev/NEU/1075_DFA_NEU_XX.wav.npz: should be NEU but came out as DIS
                   Preprocessed/Dev/NEU/1055_IWL_NEU_XX.wav.npz: should be NEU but came out as DIS
                   Preprocessed/Dev/NEU/1024_WSI_NEU_XX.wav.npz: should be NEU but came out as SAD
                   Preprocessed/Dev/NEU/1067_IWW_NEU_XX.wav.npz: should be NEU but came out as FEA
                   Preprocessed/Dev/NEU/1043_IWW_NEU_XX.wav.npz: should be NEU but came out as DIS
          class 'SAD': 5
                   Preprocessed/Dev/SAD/1089_ITH_SAD_XX.wav.npz: should be SAD but came out as DIS
                   Preprocessed/Dev/SAD/1083_ITS_SAD_XX.wav.npz: should be SAD but came out as FEA
                   Preprocessed/Dev/SAD/1079_IEO_SAD_LO.wav.npz: should be SAD but came out as FEA
                   Preprocessed/Dev/SAD/1019_MTI_SAD_XX.wav.npz: should be SAD but came out as NEU
                   Preprocessed/Dev/SAD/1028_IWW_SAD_XX.wav.npz: should be SAD but came out as HAP
Measuring ROC...
Global AUC =  0.8424179082416615

Drawing ROC curves...
Saving curves to file roc_curves.png

[[28  0  2 13  1  0]
 [ 3 10  3  6 13  7]
 [ 4  3 26 11  6 12]
 [ 1  3  9 27  6  1]
 [ 0  3  1  4 20  3]
 [ 0  1  2  1  1  9]]
Running model.evaluate...
240/240 [==============================] - 10s 42ms/step
Test loss: 1.2682289083798726
Test accuracy: 0.5
All model scores:
['loss', 'accuracy']
[1.2682289083798726, 0.5]

Finished.
(tensorflow) DNa1c06a0:panotti evangelie$ python eval_network.py -w "batchsize20.weights.hdf5"
Using TensorFlow backend.
class_names =  ['ANG', 'DIS', 'FEA', 'HAP', 'NEU', 'SAD']
       total files =  266 , going to load total_load =  240
total files =  266 , going to load total_load =  240
   get_sample_dimensions: 1075_IEO_ANG_HI.wav.npz: melgram.shape =  (1, 96, 420, 1)
 melgram dimensions:  (1, 96, 420, 1)

 Loading class 1/6: 'ANG', File 1/44: Preprocessed/Dev/ANG/1066_IWL_ANG_XX.wav.n Loading class 1/6: 'ANG', File 44/44: Preprocessed/Dev/ANG/1004_TSI_ANG_XX.wav.npz                  
 Loading class 2/6: 'DIS', File 1/42: Preprocessed/Dev/DIS/1024_IEO_DIS_MD.wav.n Loading class 2/6: 'DIS', File 42/42: Preprocessed/Dev/DIS/1085_DFA_DIS_XX.wav.npz                  
 Loading class 3/6: 'FEA', File 1/62: Preprocessed/Dev/FEA/1004_ITH_FEA_XX.wav.n Loading class 3/6: 'FEA', File 62/62: Preprocessed/Dev/FEA/1060_TAI_FEA_XX.wav.npz                  
 Loading class 4/6: 'HAP', File 1/47: Preprocessed/Dev/HAP/1040_IWL_HAP_XX.wav.n Loading class 4/6: 'HAP', File 47/47: Preprocessed/Dev/HAP/1087_IEO_HAP_HI.wav.npz                  
 Loading class 5/6: 'NEU', File 1/31: Preprocessed/Dev/NEU/1088_IOM_NEU_XX.wav.n Loading class 5/6: 'NEU', File 31/31: Preprocessed/Dev/NEU/1083_IWL_NEU_XX.wav.npz                  
 Loading class 6/6: 'SAD', File 1/40: Preprocessed/Dev/SAD/1019_IEO_SAD_HI.wav.npz                  
class names =  ['ANG', 'DIS', 'FEA', 'HAP', 'NEU', 'SAD']
 MyCNN_Keras2: X_shape =  (240, 96, 420, 1) , channels =  1
2019-12-08 21:59:17.677374: I tensorflow/core/platform/cpu_feature_guard.cc:145] This TensorFlow binary is optimized with Intel(R) MKL-DNN to use the following CPU instructions in performance critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in non-MKL-DNN operations, rebuild TensorFlow with the appropriate compiler flags.
2019-12-08 21:59:17.677731: I tensorflow/core/common_runtime/process_util.cc:115] Creating new thread pool with default inter op setting: 4. Tune using inter_op_parallelism_threads for best performance.
WARNING:tensorflow:Large dropout rate: 0.6 (>0.5). In TensorFlow 2.x, dropout() uses dropout rate instead of keep_prob. Please ensure that this is intended.
Looking for previous weights...
Need weights file to continue.  Aborting
Traceback (most recent call last):
  File "eval_network.py", line 180, in <module>
    eval_network(weights_file=args.weights, classpath=args.classpath, batch_size=args.batch_size)
  File "eval_network.py", line 70, in eval_network
    model, serial_model = setup_model(X_test, class_names, weights_file_in=weights_file, missing_weights_fatal=True)
  File "/Users/evangelie/Documents/GitHub/panotti/panotti/models.py", line 230, in setup_model
    assert(not missing_weights_fatal)
AssertionError
(tensorflow) DNa1c06a0:panotti evangelie$ python eval_network.py -weights "batchsize20.weights.hdf5"
Using TensorFlow backend.
usage: eval_network.py [-h] [-w WEIGHTS] [-c CLASSPATH]
                       [--batch_size BATCH_SIZE]
eval_network.py: error: unrecognized arguments: batchsize20.weights.hdf5
(tensorflow) DNa1c06a0:panotti evangelie$ python eval_network.py -w "batchsize20weights.hdf5"
Using TensorFlow backend.
class_names =  ['ANG', 'DIS', 'FEA', 'HAP', 'NEU', 'SAD']
       total files =  266 , going to load total_load =  240
total files =  266 , going to load total_load =  240
   get_sample_dimensions: 1075_IEO_ANG_HI.wav.npz: melgram.shape =  (1, 96, 420, 1)
 melgram dimensions:  (1, 96, 420, 1)

 Loading class 1/6: 'ANG', File 1/44: Preprocessed/Dev/ANG/1029_IEO_ANG_HI.wav.n Loading class 1/6: 'ANG', File 44/44: Preprocessed/Dev/ANG/1018_TAI_ANG_XX.wav.npz                  
 Loading class 2/6: 'DIS', File 1/42: Preprocessed/Dev/DIS/1002_ITH_DIS_XX.wav.n Loading class 2/6: 'DIS', File 42/42: Preprocessed/Dev/DIS/1088_ITS_DIS_XX.wav.npz                  
 Loading class 3/6: 'FEA', File 1/62: Preprocessed/Dev/FEA/1058_ITS_FEA_XX.wav.n Loading class 3/6: 'FEA', File 62/62: Preprocessed/Dev/FEA/1089_TSI_FEA_XX.wav.npz                  
 Loading class 4/6: 'HAP', File 1/47: Preprocessed/Dev/HAP/1025_IOM_HAP_XX.wav.n Loading class 4/6: 'HAP', File 47/47: Preprocessed/Dev/HAP/1074_ITS_HAP_XX.wav.npz                  
 Loading class 5/6: 'NEU', File 1/31: Preprocessed/Dev/NEU/1083_IWL_NEU_XX.wav.n Loading class 5/6: 'NEU', File 31/31: Preprocessed/Dev/NEU/1088_IOM_NEU_XX.wav.npz                  
 Loading class 6/6: 'SAD', File 1/40: Preprocessed/Dev/SAD/1077_MTI_SAD_XX.wav.npz                  
class names =  ['ANG', 'DIS', 'FEA', 'HAP', 'NEU', 'SAD']
 MyCNN_Keras2: X_shape =  (240, 96, 420, 1) , channels =  1
2019-12-08 21:59:48.054292: I tensorflow/core/platform/cpu_feature_guard.cc:145] This TensorFlow binary is optimized with Intel(R) MKL-DNN to use the following CPU instructions in performance critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in non-MKL-DNN operations, rebuild TensorFlow with the appropriate compiler flags.
2019-12-08 21:59:48.054615: I tensorflow/core/common_runtime/process_util.cc:115] Creating new thread pool with default inter op setting: 4. Tune using inter_op_parallelism_threads for best performance.
WARNING:tensorflow:Large dropout rate: 0.6 (>0.5). In TensorFlow 2.x, dropout() uses dropout rate instead of keep_prob. Please ensure that this is intended.
Looking for previous weights...
Weights file detected. Loading from  batchsize20weights.hdf5
 Available GPUs =  [] , count =  0
Summary of serial model (duplicated across 0 GPUs):
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
Input (Conv2D)               (None, 96, 420, 32)       320       
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 48, 210, 32)       0         
_________________________________________________________________
activation_1 (Activation)    (None, 48, 210, 32)       0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 48, 210, 32)       128       
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 48, 210, 32)       9248      
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 24, 105, 32)       0         
_________________________________________________________________
activation_2 (Activation)    (None, 24, 105, 32)       0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 24, 105, 32)       0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 24, 105, 32)       9248      
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 12, 52, 32)        0         
_________________________________________________________________
activation_3 (Activation)    (None, 12, 52, 32)        0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 12, 52, 32)        0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 12, 52, 32)        9248      
_________________________________________________________________
max_pooling2d_4 (MaxPooling2 (None, 6, 26, 32)         0         
_________________________________________________________________
activation_4 (Activation)    (None, 6, 26, 32)         0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 6, 26, 32)         0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 4992)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 128)               639104    
_________________________________________________________________
activation_5 (Activation)    (None, 128)               0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 6)                 774       
_________________________________________________________________
Output (Activation)          (None, 6)                 0         
=================================================================
Total params: 668,070
Trainable params: 668,006
Non-trainable params: 64
_________________________________________________________________
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
Input (Conv2D)               (None, 96, 420, 32)       320       
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 48, 210, 32)       0         
_________________________________________________________________
activation_1 (Activation)    (None, 48, 210, 32)       0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 48, 210, 32)       128       
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 48, 210, 32)       9248      
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 24, 105, 32)       0         
_________________________________________________________________
activation_2 (Activation)    (None, 24, 105, 32)       0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 24, 105, 32)       0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 24, 105, 32)       9248      
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 12, 52, 32)        0         
_________________________________________________________________
activation_3 (Activation)    (None, 12, 52, 32)        0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 12, 52, 32)        0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 12, 52, 32)        9248      
_________________________________________________________________
max_pooling2d_4 (MaxPooling2 (None, 6, 26, 32)         0         
_________________________________________________________________
activation_4 (Activation)    (None, 6, 26, 32)         0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 6, 26, 32)         0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 4992)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 128)               639104    
_________________________________________________________________
activation_5 (Activation)    (None, 128)               0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 6)                 774       
_________________________________________________________________
Output (Activation)          (None, 6)                 0         
=================================================================
Total params: 668,070
Trainable params: 668,006
Non-trainable params: 64
_________________________________________________________________
Running predict...
Counting mistakes 
    Found 141 total mistakes out of 240 attempts
      Mistakes by class: 
          class 'ANG': 20
                   Preprocessed/Dev/ANG/1051_TIE_ANG_XX.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1004_TSI_ANG_XX.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1009_TAI_ANG_XX.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1071_IEO_ANG_LO.wav.npz: should be ANG but came out as DIS
                   Preprocessed/Dev/ANG/1040_TAI_ANG_XX.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1006_TSI_ANG_XX.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1073_ITS_ANG_XX.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1029_IEO_ANG_HI.wav.npz: should be ANG but came out as FEA
                   Preprocessed/Dev/ANG/1090_IEO_ANG_LO.wav.npz: should be ANG but came out as DIS
                   Preprocessed/Dev/ANG/1089_WSI_ANG_XX.wav.npz: should be ANG but came out as FEA
                   Preprocessed/Dev/ANG/1051_ITH_ANG_XX.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1062_TIE_ANG_XX.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1041_IWW_ANG_XX.wav.npz: should be ANG but came out as FEA
                   Preprocessed/Dev/ANG/1077_MTI_ANG_XX.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1078_MTI_ANG_XX.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1042_IEO_ANG_MD.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1001_IEO_ANG_MD.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1018_TAI_ANG_XX.wav.npz: should be ANG but came out as DIS
                   Preprocessed/Dev/ANG/1085_IWW_ANG_XX.wav.npz: should be ANG but came out as FEA
                   Preprocessed/Dev/ANG/1019_IEO_ANG_MD.wav.npz: should be ANG but came out as HAP
          class 'DIS': 30
                   Preprocessed/Dev/DIS/1037_MTI_DIS_XX.wav.npz: should be DIS but came out as SAD
                   Preprocessed/Dev/DIS/1088_ITS_DIS_XX.wav.npz: should be DIS but came out as ANG
                   Preprocessed/Dev/DIS/1053_IEO_DIS_MD.wav.npz: should be DIS but came out as HAP
                   Preprocessed/Dev/DIS/1059_MTI_DIS_XX.wav.npz: should be DIS but came out as HAP
                   Preprocessed/Dev/DIS/1088_IWL_DIS_XX.wav.npz: should be DIS but came out as SAD
                   Preprocessed/Dev/DIS/1041_TIE_DIS_XX.wav.npz: should be DIS but came out as SAD
                   Preprocessed/Dev/DIS/1074_IEO_DIS_HI.wav.npz: should be DIS but came out as FEA
                   Preprocessed/Dev/DIS/1056_TSI_DIS_XX.wav.npz: should be DIS but came out as HAP
                   Preprocessed/Dev/DIS/1060_IWL_DIS_XX.wav.npz: should be DIS but came out as NEU
                   Preprocessed/Dev/DIS/1069_ITH_DIS_XX.wav.npz: should be DIS but came out as FEA
                   Preprocessed/Dev/DIS/1030_TIE_DIS_XX.wav.npz: should be DIS but came out as HAP
                   Preprocessed/Dev/DIS/1058_TAI_DIS_XX.wav.npz: should be DIS but came out as NEU
                   Preprocessed/Dev/DIS/1005_IEO_DIS_MD.wav.npz: should be DIS but came out as ANG
                   Preprocessed/Dev/DIS/1033_WSI_DIS_XX.wav.npz: should be DIS but came out as FEA
                   Preprocessed/Dev/DIS/1085_DFA_DIS_XX.wav.npz: should be DIS but came out as HAP
                   Preprocessed/Dev/DIS/1011_IEO_DIS_HI.wav.npz: should be DIS but came out as HAP
                   Preprocessed/Dev/DIS/1062_IEO_DIS_HI.wav.npz: should be DIS but came out as FEA
                   Preprocessed/Dev/DIS/1024_TSI_DIS_XX.wav.npz: should be DIS but came out as SAD
                   Preprocessed/Dev/DIS/1044_IWL_DIS_XX.wav.npz: should be DIS but came out as ANG
                   Preprocessed/Dev/DIS/1078_ITS_DIS_XX.wav.npz: should be DIS but came out as NEU
                   Preprocessed/Dev/DIS/1042_IWW_DIS_XX.wav.npz: should be DIS but came out as SAD
                   Preprocessed/Dev/DIS/1053_IWW_DIS_XX.wav.npz: should be DIS but came out as NEU
                   Preprocessed/Dev/DIS/1072_IOM_DIS_XX.wav.npz: should be DIS but came out as FEA
                   Preprocessed/Dev/DIS/1060_TSI_DIS_XX.wav.npz: should be DIS but came out as NEU
                   Preprocessed/Dev/DIS/1072_ITS_DIS_XX.wav.npz: should be DIS but came out as HAP
                   Preprocessed/Dev/DIS/1074_ITH_DIS_XX.wav.npz: should be DIS but came out as FEA
                   Preprocessed/Dev/DIS/1062_MTI_DIS_XX.wav.npz: should be DIS but came out as SAD
                   Preprocessed/Dev/DIS/1048_MTI_DIS_XX.wav.npz: should be DIS but came out as HAP
                   Preprocessed/Dev/DIS/1020_DFA_DIS_XX.wav.npz: should be DIS but came out as FEA
                   Preprocessed/Dev/DIS/1024_IEO_DIS_MD.wav.npz: should be DIS but came out as HAP
          class 'FEA': 40
                   Preprocessed/Dev/FEA/1067_WSI_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1073_IEO_FEA_LO.wav.npz: should be FEA but came out as DIS
                   Preprocessed/Dev/FEA/1060_IEO_FEA_LO.wav.npz: should be FEA but came out as SAD
                   Preprocessed/Dev/FEA/1036_WSI_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1080_IEO_FEA_MD.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1075_ITH_FEA_XX.wav.npz: should be FEA but came out as SAD
                   Preprocessed/Dev/FEA/1020_TAI_FEA_XX.wav.npz: should be FEA but came out as NEU
                   Preprocessed/Dev/FEA/1036_TAI_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1007_IEO_FEA_MD.wav.npz: should be FEA but came out as NEU
                   Preprocessed/Dev/FEA/1083_TSI_FEA_XX.wav.npz: should be FEA but came out as SAD
                   Preprocessed/Dev/FEA/1023_TIE_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1038_ITH_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1064_WSI_FEA_XX.wav.npz: should be FEA but came out as ANG
                   Preprocessed/Dev/FEA/1003_TAI_FEA_XX.wav.npz: should be FEA but came out as NEU
                   Preprocessed/Dev/FEA/1031_TSI_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1074_IWL_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1062_MTI_FEA_XX.wav.npz: should be FEA but came out as SAD
                   Preprocessed/Dev/FEA/1018_TAI_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1023_WSI_FEA_XX.wav.npz: should be FEA but came out as ANG
                   Preprocessed/Dev/FEA/1050_IOM_FEA_XX.wav.npz: should be FEA but came out as NEU
                   Preprocessed/Dev/FEA/1038_IEO_FEA_HI.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1055_IWL_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1075_TAI_FEA_XX.wav.npz: should be FEA but came out as NEU
                   Preprocessed/Dev/FEA/1063_DFA_FEA_XX.wav.npz: should be FEA but came out as NEU
                   Preprocessed/Dev/FEA/1027_IOM_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1017_IEO_FEA_LO.wav.npz: should be FEA but came out as SAD
                   Preprocessed/Dev/FEA/1076_TIE_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1007_WSI_FEA_XX.wav.npz: should be FEA but came out as SAD
                   Preprocessed/Dev/FEA/1019_WSI_FEA_XX.wav.npz: should be FEA but came out as NEU
                   Preprocessed/Dev/FEA/1017_MTI_FEA_XX.wav.npz: should be FEA but came out as SAD
                   Preprocessed/Dev/FEA/1062_DFA_FEA_XX.wav.npz: should be FEA but came out as SAD
                   Preprocessed/Dev/FEA/1075_IWW_FEA_XX.wav.npz: should be FEA but came out as SAD
                   Preprocessed/Dev/FEA/1069_TAI_FEA_XX.wav.npz: should be FEA but came out as ANG
                   Preprocessed/Dev/FEA/1058_TAI_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1058_ITS_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1082_DFA_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1057_IOM_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1004_ITH_FEA_XX.wav.npz: should be FEA but came out as DIS
                   Preprocessed/Dev/FEA/1088_IWW_FEA_XX.wav.npz: should be FEA but came out as SAD
                   Preprocessed/Dev/FEA/1028_IEO_FEA_HI.wav.npz: should be FEA but came out as HAP
          class 'HAP': 27
                   Preprocessed/Dev/HAP/1074_ITS_HAP_XX.wav.npz: should be HAP but came out as ANG
                   Preprocessed/Dev/HAP/1030_ITS_HAP_XX.wav.npz: should be HAP but came out as FEA
                   Preprocessed/Dev/HAP/1042_TIE_HAP_XX.wav.npz: should be HAP but came out as FEA
                   Preprocessed/Dev/HAP/1039_IWL_HAP_XX.wav.npz: should be HAP but came out as ANG
                   Preprocessed/Dev/HAP/1051_TIE_HAP_XX.wav.npz: should be HAP but came out as FEA
                   Preprocessed/Dev/HAP/1025_IOM_HAP_XX.wav.npz: should be HAP but came out as FEA
                   Preprocessed/Dev/HAP/1029_IEO_HAP_LO.wav.npz: should be HAP but came out as DIS
                   Preprocessed/Dev/HAP/1040_IWL_HAP_XX.wav.npz: should be HAP but came out as FEA
                   Preprocessed/Dev/HAP/1058_IWL_HAP_XX.wav.npz: should be HAP but came out as FEA
                   Preprocessed/Dev/HAP/1081_IEO_HAP_LO.wav.npz: should be HAP but came out as ANG
                   Preprocessed/Dev/HAP/1054_WSI_HAP_XX.wav.npz: should be HAP but came out as FEA
                   Preprocessed/Dev/HAP/1041_IEO_HAP_LO.wav.npz: should be HAP but came out as SAD
                   Preprocessed/Dev/HAP/1012_IEO_HAP_LO.wav.npz: should be HAP but came out as FEA
                   Preprocessed/Dev/HAP/1051_IEO_HAP_HI.wav.npz: should be HAP but came out as ANG
                   Preprocessed/Dev/HAP/1055_MTI_HAP_XX.wav.npz: should be HAP but came out as FEA
                   Preprocessed/Dev/HAP/1029_WSI_HAP_XX.wav.npz: should be HAP but came out as FEA
                   Preprocessed/Dev/HAP/1036_TSI_HAP_XX.wav.npz: should be HAP but came out as FEA
                   Preprocessed/Dev/HAP/1022_IWW_HAP_XX.wav.npz: should be HAP but came out as SAD
                   Preprocessed/Dev/HAP/1057_ITS_HAP_XX.wav.npz: should be HAP but came out as FEA
                   Preprocessed/Dev/HAP/1034_TSI_HAP_XX.wav.npz: should be HAP but came out as ANG
                   Preprocessed/Dev/HAP/1025_IEO_HAP_LO.wav.npz: should be HAP but came out as FEA
                   Preprocessed/Dev/HAP/1088_TSI_HAP_XX.wav.npz: should be HAP but came out as FEA
                   Preprocessed/Dev/HAP/1084_TSI_HAP_XX.wav.npz: should be HAP but came out as DIS
                   Preprocessed/Dev/HAP/1059_DFA_HAP_XX.wav.npz: should be HAP but came out as FEA
                   Preprocessed/Dev/HAP/1009_WSI_HAP_XX.wav.npz: should be HAP but came out as FEA
                   Preprocessed/Dev/HAP/1058_WSI_HAP_XX.wav.npz: should be HAP but came out as ANG
                   Preprocessed/Dev/HAP/1085_TSI_HAP_XX.wav.npz: should be HAP but came out as SAD
          class 'NEU': 18
                   Preprocessed/Dev/NEU/1067_IWW_NEU_XX.wav.npz: should be NEU but came out as HAP
                   Preprocessed/Dev/NEU/1035_ITS_NEU_XX.wav.npz: should be NEU but came out as FEA
                   Preprocessed/Dev/NEU/1043_IWW_NEU_XX.wav.npz: should be NEU but came out as ANG
                   Preprocessed/Dev/NEU/1019_DFA_NEU_XX.wav.npz: should be NEU but came out as HAP
                   Preprocessed/Dev/NEU/1078_IEO_NEU_XX.wav.npz: should be NEU but came out as SAD
                   Preprocessed/Dev/NEU/1067_ITH_NEU_XX.wav.npz: should be NEU but came out as FEA
                   Preprocessed/Dev/NEU/1023_DFA_NEU_XX.wav.npz: should be NEU but came out as HAP
                   Preprocessed/Dev/NEU/1073_WSI_NEU_XX.wav.npz: should be NEU but came out as HAP
                   Preprocessed/Dev/NEU/1089_TSI_NEU_XX.wav.npz: should be NEU but came out as FEA
                   Preprocessed/Dev/NEU/1056_ITH_NEU_XX.wav.npz: should be NEU but came out as HAP
                   Preprocessed/Dev/NEU/1075_DFA_NEU_XX.wav.npz: should be NEU but came out as DIS
                   Preprocessed/Dev/NEU/1070_TIE_NEU_XX.wav.npz: should be NEU but came out as HAP
                   Preprocessed/Dev/NEU/1026_TIE_NEU_XX.wav.npz: should be NEU but came out as SAD
                   Preprocessed/Dev/NEU/1086_TSI_NEU_XX.wav.npz: should be NEU but came out as HAP
                   Preprocessed/Dev/NEU/1042_TSI_NEU_XX.wav.npz: should be NEU but came out as FEA
                   Preprocessed/Dev/NEU/1088_IOM_NEU_XX.wav.npz: should be NEU but came out as HAP
                   Preprocessed/Dev/NEU/1036_TIE_NEU_XX.wav.npz: should be NEU but came out as DIS
                   Preprocessed/Dev/NEU/1063_TIE_NEU_XX.wav.npz: should be NEU but came out as DIS
          class 'SAD': 6
                   Preprocessed/Dev/SAD/1039_TSI_SAD_XX.wav.npz: should be SAD but came out as FEA
                   Preprocessed/Dev/SAD/1053_ITS_SAD_XX.wav.npz: should be SAD but came out as FEA
                   Preprocessed/Dev/SAD/1033_ITS_SAD_XX.wav.npz: should be SAD but came out as FEA
                   Preprocessed/Dev/SAD/1037_IEO_SAD_LO.wav.npz: should be SAD but came out as HAP
                   Preprocessed/Dev/SAD/1022_IEO_SAD_MD.wav.npz: should be SAD but came out as FEA
                   Preprocessed/Dev/SAD/1055_IEO_SAD_LO.wav.npz: should be SAD but came out as FEA
Measuring ROC...
Global AUC =  0.8046937846251847

Drawing ROC curves...
Saving curves to file roc_curves.png

[[24  3  4 13  0  0]
 [ 3 12  7  9  5  6]
 [ 3  2 22 18  7 10]
 [ 6  2 16 20  0  3]
 [ 1  3  4  8 13  2]
 [ 0  0  5  1  0  8]]
Running model.evaluate...
240/240 [==============================] - 10s 41ms/step
Test loss: 1.8854046861330669
Test accuracy: 0.4124999940395355
All model scores:
['loss', 'accuracy']
[1.8854046861330669, 0.4124999940395355]

Finished.
(tensorflow) DNa1c06a0:panotti evangelie$ python eval_network.py
Using TensorFlow backend.
class_names =  ['ANG', 'DIS', 'FEA', 'HAP', 'NEU', 'SAD']
       total files =  266 , going to load total_load =  240
total files =  266 , going to load total_load =  240
   get_sample_dimensions: 1075_IEO_ANG_HI.wav.npz: melgram.shape =  (1, 96, 420, 1)
 melgram dimensions:  (1, 96, 420, 1)

 Loading class 1/6: 'ANG', File 1/44: Preprocessed/Dev/ANG/1001_IEO_ANG_MD.wav.n Loading class 1/6: 'ANG', File 44/44: Preprocessed/Dev/ANG/1090_TAI_ANG_XX.wav.npz                  
 Loading class 2/6: 'DIS', File 1/42: Preprocessed/Dev/DIS/1024_IEO_DIS_MD.wav.n Loading class 2/6: 'DIS', File 42/42: Preprocessed/Dev/DIS/1056_TSI_DIS_XX.wav.npz                  
 Loading class 3/6: 'FEA', File 1/62: Preprocessed/Dev/FEA/1007_WSI_FEA_XX.wav.n Loading class 3/6: 'FEA', File 62/62: Preprocessed/Dev/FEA/1069_IWW_FEA_XX.wav.npz                  
 Loading class 4/6: 'HAP', File 1/47: Preprocessed/Dev/HAP/1033_MTI_HAP_XX.wav.n Loading class 4/6: 'HAP', File 47/47: Preprocessed/Dev/HAP/1026_IOM_HAP_XX.wav.npz                  
 Loading class 5/6: 'NEU', File 1/31: Preprocessed/Dev/NEU/1054_ITS_NEU_XX.wav.n Loading class 5/6: 'NEU', File 31/31: Preprocessed/Dev/NEU/1088_IOM_NEU_XX.wav.npz                  
 Loading class 6/6: 'SAD', File 1/40: Preprocessed/Dev/SAD/1057_IOM_SAD_XX.wav.npz                  
class names =  ['ANG', 'DIS', 'FEA', 'HAP', 'NEU', 'SAD']
 MyCNN_Keras2: X_shape =  (240, 96, 420, 1) , channels =  1
2019-12-08 22:02:35.565823: I tensorflow/core/platform/cpu_feature_guard.cc:145] This TensorFlow binary is optimized with Intel(R) MKL-DNN to use the following CPU instructions in performance critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in non-MKL-DNN operations, rebuild TensorFlow with the appropriate compiler flags.
2019-12-08 22:02:35.566165: I tensorflow/core/common_runtime/process_util.cc:115] Creating new thread pool with default inter op setting: 4. Tune using inter_op_parallelism_threads for best performance.
WARNING:tensorflow:Large dropout rate: 0.6 (>0.5). In TensorFlow 2.x, dropout() uses dropout rate instead of keep_prob. Please ensure that this is intended.
Looking for previous weights...
Weights file detected. Loading from  60.5_convdropout0.5densedropout0.7weights.hdf5
WARNING:tensorflow:Large dropout rate: 0.7 (>0.5). In TensorFlow 2.x, dropout() uses dropout rate instead of keep_prob. Please ensure that this is intended.
 Available GPUs =  [] , count =  0
Summary of serial model (duplicated across 0 GPUs):
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
Input (Conv2D)               (None, 96, 420, 32)       320       
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 48, 210, 32)       0         
_________________________________________________________________
activation_1 (Activation)    (None, 48, 210, 32)       0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 48, 210, 32)       128       
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 48, 210, 32)       9248      
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 24, 105, 32)       0         
_________________________________________________________________
activation_2 (Activation)    (None, 24, 105, 32)       0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 24, 105, 32)       0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 24, 105, 32)       9248      
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 12, 52, 32)        0         
_________________________________________________________________
activation_3 (Activation)    (None, 12, 52, 32)        0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 12, 52, 32)        0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 12, 52, 32)        9248      
_________________________________________________________________
max_pooling2d_4 (MaxPooling2 (None, 6, 26, 32)         0         
_________________________________________________________________
activation_4 (Activation)    (None, 6, 26, 32)         0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 6, 26, 32)         0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 4992)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 128)               639104    
_________________________________________________________________
activation_5 (Activation)    (None, 128)               0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 6)                 774       
_________________________________________________________________
Output (Activation)          (None, 6)                 0         
=================================================================
Total params: 668,070
Trainable params: 668,006
Non-trainable params: 64
_________________________________________________________________
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
Input (Conv2D)               (None, 96, 420, 32)       320       
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 48, 210, 32)       0         
_________________________________________________________________
activation_1 (Activation)    (None, 48, 210, 32)       0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 48, 210, 32)       128       
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 48, 210, 32)       9248      
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 24, 105, 32)       0         
_________________________________________________________________
activation_2 (Activation)    (None, 24, 105, 32)       0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 24, 105, 32)       0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 24, 105, 32)       9248      
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 12, 52, 32)        0         
_________________________________________________________________
activation_3 (Activation)    (None, 12, 52, 32)        0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 12, 52, 32)        0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 12, 52, 32)        9248      
_________________________________________________________________
max_pooling2d_4 (MaxPooling2 (None, 6, 26, 32)         0         
_________________________________________________________________
activation_4 (Activation)    (None, 6, 26, 32)         0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 6, 26, 32)         0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 4992)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 128)               639104    
_________________________________________________________________
activation_5 (Activation)    (None, 128)               0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 6)                 774       
_________________________________________________________________
Output (Activation)          (None, 6)                 0         
=================================================================
Total params: 668,070
Trainable params: 668,006
Non-trainable params: 64
_________________________________________________________________
Running predict...
Counting mistakes 
    Found 120 total mistakes out of 240 attempts
      Mistakes by class: 
          class 'ANG': 16
                   Preprocessed/Dev/ANG/1078_MTI_ANG_XX.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1042_IEO_ANG_MD.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1001_IEO_ANG_MD.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1089_WSI_ANG_XX.wav.npz: should be ANG but came out as FEA
                   Preprocessed/Dev/ANG/1077_MTI_ANG_XX.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1071_IEO_ANG_LO.wav.npz: should be ANG but came out as NEU
                   Preprocessed/Dev/ANG/1090_IEO_ANG_LO.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1019_DFA_ANG_XX.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1019_IEO_ANG_MD.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1060_IEO_ANG_MD.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1006_TSI_ANG_XX.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1018_TAI_ANG_XX.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1073_ITS_ANG_XX.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1085_IWW_ANG_XX.wav.npz: should be ANG but came out as HAP
                   Preprocessed/Dev/ANG/1009_TAI_ANG_XX.wav.npz: should be ANG but came out as FEA
                   Preprocessed/Dev/ANG/1040_TAI_ANG_XX.wav.npz: should be ANG but came out as HAP
          class 'DIS': 32
                   Preprocessed/Dev/DIS/1079_IEO_DIS_LO.wav.npz: should be DIS but came out as HAP
                   Preprocessed/Dev/DIS/1037_MTI_DIS_XX.wav.npz: should be DIS but came out as SAD
                   Preprocessed/Dev/DIS/1056_TSI_DIS_XX.wav.npz: should be DIS but came out as HAP
                   Preprocessed/Dev/DIS/1060_TSI_DIS_XX.wav.npz: should be DIS but came out as SAD
                   Preprocessed/Dev/DIS/1078_ITS_DIS_XX.wav.npz: should be DIS but came out as HAP
                   Preprocessed/Dev/DIS/1085_DFA_DIS_XX.wav.npz: should be DIS but came out as NEU
                   Preprocessed/Dev/DIS/1037_ITS_DIS_XX.wav.npz: should be DIS but came out as SAD
                   Preprocessed/Dev/DIS/1041_TIE_DIS_XX.wav.npz: should be DIS but came out as SAD
                   Preprocessed/Dev/DIS/1060_IWL_DIS_XX.wav.npz: should be DIS but came out as NEU
                   Preprocessed/Dev/DIS/1086_TIE_DIS_XX.wav.npz: should be DIS but came out as NEU
                   Preprocessed/Dev/DIS/1033_WSI_DIS_XX.wav.npz: should be DIS but came out as FEA
                   Preprocessed/Dev/DIS/1074_IEO_DIS_HI.wav.npz: should be DIS but came out as ANG
                   Preprocessed/Dev/DIS/1048_MTI_DIS_XX.wav.npz: should be DIS but came out as FEA
                   Preprocessed/Dev/DIS/1072_IOM_DIS_XX.wav.npz: should be DIS but came out as FEA
                   Preprocessed/Dev/DIS/1053_IEO_DIS_MD.wav.npz: should be DIS but came out as NEU
                   Preprocessed/Dev/DIS/1062_IEO_DIS_HI.wav.npz: should be DIS but came out as NEU
                   Preprocessed/Dev/DIS/1019_TAI_DIS_XX.wav.npz: should be DIS but came out as NEU
                   Preprocessed/Dev/DIS/1059_TAI_DIS_XX.wav.npz: should be DIS but came out as NEU
                   Preprocessed/Dev/DIS/1069_ITH_DIS_XX.wav.npz: should be DIS but came out as NEU
                   Preprocessed/Dev/DIS/1024_TSI_DIS_XX.wav.npz: should be DIS but came out as SAD
                   Preprocessed/Dev/DIS/1005_IEO_DIS_MD.wav.npz: should be DIS but came out as HAP
                   Preprocessed/Dev/DIS/1067_TSI_DIS_XX.wav.npz: should be DIS but came out as NEU
                   Preprocessed/Dev/DIS/1011_IEO_DIS_HI.wav.npz: should be DIS but came out as HAP
                   Preprocessed/Dev/DIS/1062_MTI_DIS_XX.wav.npz: should be DIS but came out as SAD
                   Preprocessed/Dev/DIS/1042_IWW_DIS_XX.wav.npz: should be DIS but came out as NEU
                   Preprocessed/Dev/DIS/1001_IWW_DIS_XX.wav.npz: should be DIS but came out as NEU
                   Preprocessed/Dev/DIS/1053_IWW_DIS_XX.wav.npz: should be DIS but came out as NEU
                   Preprocessed/Dev/DIS/1088_ITS_DIS_XX.wav.npz: should be DIS but came out as NEU
                   Preprocessed/Dev/DIS/1072_ITS_DIS_XX.wav.npz: should be DIS but came out as HAP
                   Preprocessed/Dev/DIS/1020_DFA_DIS_XX.wav.npz: should be DIS but came out as SAD
                   Preprocessed/Dev/DIS/1044_IWL_DIS_XX.wav.npz: should be DIS but came out as ANG
                   Preprocessed/Dev/DIS/1074_ITH_DIS_XX.wav.npz: should be DIS but came out as ANG
          class 'FEA': 36
                   Preprocessed/Dev/FEA/1060_IEO_FEA_LO.wav.npz: should be FEA but came out as SAD
                   Preprocessed/Dev/FEA/1083_TSI_FEA_XX.wav.npz: should be FEA but came out as DIS
                   Preprocessed/Dev/FEA/1075_ITH_FEA_XX.wav.npz: should be FEA but came out as SAD
                   Preprocessed/Dev/FEA/1080_IEO_FEA_MD.wav.npz: should be FEA but came out as SAD
                   Preprocessed/Dev/FEA/1020_TAI_FEA_XX.wav.npz: should be FEA but came out as NEU
                   Preprocessed/Dev/FEA/1023_TIE_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1075_IWW_FEA_XX.wav.npz: should be FEA but came out as SAD
                   Preprocessed/Dev/FEA/1050_IOM_FEA_XX.wav.npz: should be FEA but came out as SAD
                   Preprocessed/Dev/FEA/1088_IWW_FEA_XX.wav.npz: should be FEA but came out as SAD
                   Preprocessed/Dev/FEA/1060_TAI_FEA_XX.wav.npz: should be FEA but came out as NEU
                   Preprocessed/Dev/FEA/1089_TSI_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1073_IEO_FEA_LO.wav.npz: should be FEA but came out as NEU
                   Preprocessed/Dev/FEA/1055_IWL_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1058_TAI_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1062_DFA_FEA_XX.wav.npz: should be FEA but came out as SAD
                   Preprocessed/Dev/FEA/1069_IWW_FEA_XX.wav.npz: should be FEA but came out as NEU
                   Preprocessed/Dev/FEA/1017_IEO_FEA_LO.wav.npz: should be FEA but came out as SAD
                   Preprocessed/Dev/FEA/1062_MTI_FEA_XX.wav.npz: should be FEA but came out as SAD
                   Preprocessed/Dev/FEA/1062_IOM_FEA_XX.wav.npz: should be FEA but came out as NEU
                   Preprocessed/Dev/FEA/1018_TAI_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1007_IEO_FEA_MD.wav.npz: should be FEA but came out as DIS
                   Preprocessed/Dev/FEA/1033_DFA_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1064_WSI_FEA_XX.wav.npz: should be FEA but came out as ANG
                   Preprocessed/Dev/FEA/1004_ITH_FEA_XX.wav.npz: should be FEA but came out as DIS
                   Preprocessed/Dev/FEA/1063_DFA_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1082_DFA_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1028_IEO_FEA_HI.wav.npz: should be FEA but came out as ANG
                   Preprocessed/Dev/FEA/1027_IOM_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1007_WSI_FEA_XX.wav.npz: should be FEA but came out as SAD
                   Preprocessed/Dev/FEA/1017_MTI_FEA_XX.wav.npz: should be FEA but came out as SAD
                   Preprocessed/Dev/FEA/1031_TSI_FEA_XX.wav.npz: should be FEA but came out as NEU
                   Preprocessed/Dev/FEA/1023_WSI_FEA_XX.wav.npz: should be FEA but came out as ANG
                   Preprocessed/Dev/FEA/1075_TAI_FEA_XX.wav.npz: should be FEA but came out as SAD
                   Preprocessed/Dev/FEA/1067_WSI_FEA_XX.wav.npz: should be FEA but came out as HAP
                   Preprocessed/Dev/FEA/1003_TIE_FEA_XX.wav.npz: should be FEA but came out as ANG
                   Preprocessed/Dev/FEA/1076_TIE_FEA_XX.wav.npz: should be FEA but came out as HAP
          class 'HAP': 20
                   Preprocessed/Dev/HAP/1059_DFA_HAP_XX.wav.npz: should be HAP but came out as FEA
                   Preprocessed/Dev/HAP/1030_ITS_HAP_XX.wav.npz: should be HAP but came out as FEA
                   Preprocessed/Dev/HAP/1040_IWL_HAP_XX.wav.npz: should be HAP but came out as NEU
                   Preprocessed/Dev/HAP/1022_IWW_HAP_XX.wav.npz: should be HAP but came out as NEU
                   Preprocessed/Dev/HAP/1055_MTI_HAP_XX.wav.npz: should be HAP but came out as FEA
                   Preprocessed/Dev/HAP/1025_IEO_HAP_LO.wav.npz: should be HAP but came out as NEU
                   Preprocessed/Dev/HAP/1084_TSI_HAP_XX.wav.npz: should be HAP but came out as DIS
                   Preprocessed/Dev/HAP/1029_WSI_HAP_XX.wav.npz: should be HAP but came out as FEA
                   Preprocessed/Dev/HAP/1088_TSI_HAP_XX.wav.npz: should be HAP but came out as DIS
                   Preprocessed/Dev/HAP/1012_IEO_HAP_LO.wav.npz: should be HAP but came out as FEA
                   Preprocessed/Dev/HAP/1051_TIE_HAP_XX.wav.npz: should be HAP but came out as DIS
                   Preprocessed/Dev/HAP/1058_MTI_HAP_XX.wav.npz: should be HAP but came out as FEA
                   Preprocessed/Dev/HAP/1085_TSI_HAP_XX.wav.npz: should be HAP but came out as NEU
                   Preprocessed/Dev/HAP/1045_DFA_HAP_XX.wav.npz: should be HAP but came out as NEU
                   Preprocessed/Dev/HAP/1081_IEO_HAP_LO.wav.npz: should be HAP but came out as NEU
                   Preprocessed/Dev/HAP/1039_IWL_HAP_XX.wav.npz: should be HAP but came out as ANG
                   Preprocessed/Dev/HAP/1041_IEO_HAP_LO.wav.npz: should be HAP but came out as SAD
                   Preprocessed/Dev/HAP/1008_DFA_HAP_XX.wav.npz: should be HAP but came out as FEA
                   Preprocessed/Dev/HAP/1074_ITS_HAP_XX.wav.npz: should be HAP but came out as FEA
                   Preprocessed/Dev/HAP/1025_IOM_HAP_XX.wav.npz: should be HAP but came out as FEA
          class 'NEU': 11
                   Preprocessed/Dev/NEU/1019_DFA_NEU_XX.wav.npz: should be NEU but came out as HAP
                   Preprocessed/Dev/NEU/1075_DFA_NEU_XX.wav.npz: should be NEU but came out as DIS
                   Preprocessed/Dev/NEU/1078_IEO_NEU_XX.wav.npz: should be NEU but came out as SAD
                   Preprocessed/Dev/NEU/1021_TSI_NEU_XX.wav.npz: should be NEU but came out as SAD
                   Preprocessed/Dev/NEU/1048_TSI_NEU_XX.wav.npz: should be NEU but came out as HAP
                   Preprocessed/Dev/NEU/1024_WSI_NEU_XX.wav.npz: should be NEU but came out as SAD
                   Preprocessed/Dev/NEU/1067_IWW_NEU_XX.wav.npz: should be NEU but came out as FEA
                   Preprocessed/Dev/NEU/1086_TSI_NEU_XX.wav.npz: should be NEU but came out as HAP
                   Preprocessed/Dev/NEU/1088_IOM_NEU_XX.wav.npz: should be NEU but came out as HAP
                   Preprocessed/Dev/NEU/1055_IWL_NEU_XX.wav.npz: should be NEU but came out as DIS
                   Preprocessed/Dev/NEU/1043_IWW_NEU_XX.wav.npz: should be NEU but came out as DIS
          class 'SAD': 5
                   Preprocessed/Dev/SAD/1002_DFA_SAD_XX.wav.npz: should be SAD but came out as NEU
                   Preprocessed/Dev/SAD/1077_MTI_SAD_XX.wav.npz: should be SAD but came out as HAP
                   Preprocessed/Dev/SAD/1002_TSI_SAD_XX.wav.npz: should be SAD but came out as FEA
                   Preprocessed/Dev/SAD/1028_IWW_SAD_XX.wav.npz: should be SAD but came out as HAP
                   Preprocessed/Dev/SAD/1019_MTI_SAD_XX.wav.npz: should be SAD but came out as NEU
Measuring ROC...
Global AUC =  0.8391322649224641

Drawing ROC curves...
Saving curves to file roc_curves.png

[[28  0  2 13  1  0]
 [ 3 10  3  6 13  7]
 [ 4  3 26 11  6 12]
 [ 1  3  9 27  6  1]
 [ 0  3  1  4 20  3]
 [ 0  0  1  2  2  9]]
Running model.evaluate...
240/240 [==============================] - 10s 42ms/step
Test loss: 1.2736427386601765
Test accuracy: 0.5
All model scores:
['loss', 'accuracy']
[1.2736427386601765, 0.5]

Finished.
(tensorflow) DNa1c06a0:panotti evangelie$ 
